---

- include: debian.yml
  when: ansible_os_family == 'Debian'

- name: Download Oh My Zsh
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: ~/.oh-my-zsh
    force: yes

- name: Create .zshrc
  copy:
    src: ~/.oh-my-zsh/templates/zshrc.zsh-template
    dest: ~/.zshrc
    force: no

- name: Read .zshrc
  shell: cat ~/.zshrc
  register: zshrc

- name: Change zsh theme
  replace:
    path: ~/.zshrc
    regexp: '^ZSH_THEME="robbyrussell"'
    replace: ZSH_THEME="bira"

- name: Change default shell
  user:
    name: imtiyaz
    shell: /usr/bin/zsh
  # become: yes

- name: Download z
  get_url:
    url: https://github.com/rupa/z/blob/master/z.sh
    dest: ~/.oh-my-zsh/

- name: Add z to zshrc
  lineinfile:
    path: ~/.zshrc
    line: . ~/.oh-my-zsh/z.sh

- name: Download syntax highlighting repo
  git:
    repo: https://github.com/zsh-users/zsh-syntax-highlighting.git
    dest: ~/.oh-my-zsh/zsh-syntax-highlighting

- name: Add syntax highlighting to zshrc
  lineinfile:
    path: ~/.zshrc
    line: source ~/.oh-my-zsh/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

- name: Add aliases
  blockinfile:
    path: ~/.zshrc
    marker: "# {mark} ANSIBLE ADDING ALIASES"
    block: |
      alias zshrc="vi ~/.zshrc"
      alias source-zsh="source ~/.zshrc"
      alias kube="kubectl"
